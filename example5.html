<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>javascript 교육 - plugin</title>
    <script src="https://code.jquery.com/jquery-3.2.1.min.js"></script>
</head>
<body>
    <h1>Images Viewer</h1>
    <p>
        이미지를 클릭하면 이미지 크게 보기(레이어 팝업)를 할 수 있다.
    </p>

    <p><a href="#" class="viewImage"><img src="./images/img1.jpg" alt="" width="400"></a></p>
    <p><a href="#" class="viewImage"><img src="./images/img2.jpg" alt="" width="400"></a></p>
    <p><a href="#" class="viewImage"><img src="./images/img3.jpg" alt="" width="400"></a></p>
    
    <style>
        .imgView { position: absolute; left: 0; top: 0; cursor: zoom-out; transition: all 0.3s; }
        .imgView::before { content: ''; display: block; position: fixed; left: 0; bottom: 0; width: 100%; height: 100vh; background: #fff; }
        .imgView img { position: relative; border: 5px solid #e9e9e9; }
    </style>
    <script>
        $.fn.setPosFn = function(){
            var obj = $(this);
            var w = obj.innerWidth()/2;
            var h = obj.innerHeight()/2;
            return obj.css({
                'display': 'block',
                'position': 'fixed',
                'left': '50%',
                'top': '50%',
                'margin-left': -w,
                'margin-top': -h
            })
        }

        $.fn.viewImage = function(){
            var obj = $(this);
            obj.css({'cursor':'zoom-in'}).on('click', function(e){
                e.preventDefault();
                var $t = $(this);
                var $src = $t.find('img').attr('src');
                var $top = $t.find('img').eq(0).offset().top - $('html, body').scrollTop();
                var $left = $t.find('img').eq(0).offset().left;
                activeFn($src, $top, $left);
            });
            var activeFn = function(url, top, left) {
                var html = '<div class="imgView" style="top:'+ top +'px; left:'+ left +'px;"><img src="' + url + '" alt=""></div>';
                $('html, body').css({'overflow':'hidden'});
                $('body').append(html);
                $('.imgView').setPosFn().on('click', function(){
                    $(this).remove();
                    $('html, body').css({'overflow':'visible'});
                });
            }
        }

        $('.viewImage').viewImage();
    </script>
            
    <div style="height: 2000px;"></div>
</body>
</html>